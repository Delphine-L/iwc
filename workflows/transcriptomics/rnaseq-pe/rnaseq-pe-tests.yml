- doc: Test outline for RNAseq_PE
  job:
    GTF file of annotation:
      class: File
      location: https://zenodo.org/record/4541751/files/Drosophila_melanogaster.BDGP6.87.gtf
      filetype: gtf
    Sample table:
      class: File
      path: test-data/Sample table.tabular
      filetype: tabular
    Collection paired FASTQ files:
      class: Collection
      collection_type: list:paired
      elements:
      - class: Collection
        type: paired
        identifier: GSM461177
        elements:
        - class: File
          identifier: forward
          location: https://zenodo.org/records/13888221/files/GSM461177_1.fastqsanger
        - class: File
          identifier: reverse
          location: https://zenodo.org/records/13888221/files/GSM461177_2.fastqsanger
      - class: Collection
        type: paired
        identifier: GSM461178
        elements:
        - class: File
          identifier: forward
          location: https://zenodo.org/records/13888221/files/GSM461178_1.fastqsanger
        - class: File
          identifier: reverse
          location: https://zenodo.org/records/13888221/files/GSM461178_2.fastqsanger
      - class: Collection
        type: paired
        identifier: GSM461180
        elements:
        - class: File
          identifier: forward
          location: https://zenodo.org/records/13888221/files/GSM461180_1.fastqsanger
        - class: File
          identifier: reverse
          location: https://zenodo.org/records/13888221/files/GSM461180_2.fastqsanger
      - class: Collection
        type: paired
        identifier: GSM461181
        elements:
        - class: File
          identifier: forward
          location: https://zenodo.org/records/13888221/files/GSM461181_1.fastqsanger
        - class: File
          identifier: reverse
          location: https://zenodo.org/records/13888221/files/GSM461181_2.fastqsanger
    Generate QC reports?: true
    Reference genome: dm6
    Use featureCounts for generating count tables: true
    strandedness: unstranded
    Compute Cufflinks FPKM?: false
    GTF with regions to exclude from FPKM normalization with Cufflinks: null
    Compute StringTie FPKM?: true
    DEseq2 batch factors: null
  outputs:
    Differential Expression Analysis using DESeq2:
      asserts:
        has_text_matching:
            expression: "FBgn0003360\t112.56[0-9]*\t-3.14[0-9]*\t0.32[0-9]*\t-9.76[0-9]*\t1.60[0-9]*e-[0-9]*\t1.51[0-9]*e-[0-9]*"
            expression: "FBgn0266599\t3016.67[0-9]*\t0.28[0-9]*\t0.12[0-9]*\t2.32[0-9]*\t0.019[0-9]*\t0.35[0-9]*"
    DESeq2 Plots:
      has_size:
        size: 1734460
        delta: 100000
    MultiQC stats:
      asserts:
        has_text_matching:
            expression: "GSM461177\t0.40[0-9]*\t53.41[0-9]*\t6.10[0-9]*\t0.51[0-9]*\t0.46[0-9]*\t90.66[0-9]*\t0.42[0-9]*\t82.72\t0.041[0-9]*\t5.75[0-9]*\t14.11[0-9]*\t51.0\t35.98[0-9]*\t37\t10.0\t1.51[0-9]*"
            expression: "GSM461178\t0.40[0-9]*\t57.13[0-9]*\t8.41[0-9]*\t0.50[0-9]*\t0.45[0-9]*\t90.0[0-9]*\t0.42[0-9]*\t83.26\t0.03[0-9]*\t26.94[0-9]*\t11.77[0-9]*\t52.0\t33.18[0-9]*\t36\t10.0\t1.40[0-9]*"
            expression: "GSM461180\t0.39[0-9]*\t55.57[0-9]*\t6.55[0-9]*\t0.50[0-9]*\t0.44[0-9]*\t87.32[0-9]*\t0.40[0-9]*\t80.37\t0.03[0-9]*\t24.54[0-9]*\t13.19[0-9]*\t52.0\t33.92[0-9]*\t37\t10.0\t1.40[0-9]*"
            expression: "GSM461181\t0.50[0-9]*\t58.37[0-9]*\t7.87[0-9]*\t0.61[0-9]*\t0.56[0-9]*\t91.78[0-9]*\t0.52[0-9]*\t85.24\t0.040[0-9]*\t6.07[0-9]*\t16.18[0-9]*\t53.0\t35.52[0-9]*\t37\t0.0\t1.71[0-9]*"
    Mapped Reads:
      element_tests:
        GSM461177:
          has_size:
            value: 45786533
            delta: 4000000
        GSM461178:
          has_size:
            value: 47835106
            delta: 4000000
        GSM461180:
          has_size:
            value: 48022461
            delta: 4000000
        GSM461181:
          has_size:
            value: 53477748
            delta: 4000000
    Counts Table:
      element_tests:
        GSM461180:
          asserts:
            has_text:
              text: "FBgn0027948\t276"
        GSM461181:
          asserts:
            has_text:
              text: "FBgn0027948\t297"
    Gene Abundance Estimates from StringTie:
      element_tests:
        GSM461177:
          asserts:
            has_text_matching:
              expression: "FBgn0031220\tCG4822\tchr2L\t-\t116970\t121754\t1.40[0-9]*\t49.72[0-9]*\t102.64[0-9]*"
        GSM461178:
          asserts:
            has_text_matching:
              expression: "FBgn0031220\tCG4822\tchr2L\t-\t116970\t121754\t1.16[0-9]*\t45.47[0-9]*\t84.16[0-9]*"
        GSM461180:
          asserts:
            has_text_matching:
              expression: "FBgn0031220\tCG4822\tchr2L\t-\t116970\t121754\t0.00[0-9]*\t0.00[0-9]*\t0.00[0-9]*"
        GSM461181:
          asserts:
            has_text_matching:
              expression: "FBgn0031220\tCG4822\tchr2L\t-\t116970\t121754\t1.48[0-9]*\t66.43[0-9]*\t122.54[0-9]*"
    FeatureCounts Summary Table:
      element_tests:
        GSM461177:
          asserts:
            has_text:
              text: "Assigned\t405934"
        GSM461178:
          asserts:
            has_text:
              text: "Assigned\t402322"
        GSM461180:
          asserts:
            has_text:
              text: "Assigned\t390670"
        GSM461181:
          asserts:
            has_text:
              text: "Assigned\t501297"
    Coverage of Unstranded library:
      element_tests:
        GSM461177:
          has_size:
            value: 5921419
            delta: 300000
        GSM461178:
          has_size:
            value: 5573303
            delta: 250000
        GSM461180:
          has_size:
            value: 5655990
            delta: 250000
        GSM461181:
          has_size:
            value: 6659698
            delta: 300000